# 11.团队生命周期管理和应用程序设计指南

在本章中，我们将了解如何为您的组织部署自定义团队应用程序。您将决定构建什么，构建您的 web 服务，创建应用程序包，并将该包分发给您的目标最终用户。

## 部署应用程序概述

您的 Microsoft Teams Apps 资产有多种不同的托管选项。在这一章，我将展示如何使用 Git 将团队应用资产部署到 Azure。

在之前的练习中构建和测试的应用程序已经准备好部署到 Azure，并包括各种功能，如修改 Microsoft Teams 架构，支持 Azure Application Insights，以及添加附加功能的可插拔框架。

## 运行并调试您的 Microsoft Teams 应用程序

Microsoft Teams 应用程序可以基于您最喜欢的技术和客户首选的 CDN 以多种选项运行或托管。对于调试，我们有以下选项在微软团队中运行您的应用程序。

*   纯本地的

*   在本地团队中托管

*   团队中的云托管

### 纯本地的

在纯本地 for 选项卡中，您可以使用浏览器在本地运行，并通过`http://localhost`访问内容。您可以在自己的笔记本电脑上运行和测试应用程序。这允许您在 IDE 中编译和运行，并充分利用断点和单步调试等技术。我总是推荐开发、测试、UAT 和生产环境用于现实生活中的应用程序开发。

对于纯本地的机器人，你可以使用一个机器人模拟器，记住从本地机器人模拟器运行不会给整个团队特定的功能，如花名册调用和其他渠道特定的功能。团队中不支持某些 Bot 模拟器功能。

您的本地 bot 可以在 Bot 模拟器中运行。这允许您测试机器人的一些核心逻辑，以执行简单的测试和调试，查看消息的粗略布局，并执行简单的测试。以下是步骤:

*   在本地运行代码

*   启动 Bot 模拟器并设置 URL:
    *   Node.js: `http://localhost:3978/api/messages`

    *   。NET/C#: `http://localhost:3979/api/messages`

*   将 Microsoft 应用程序 ID 和 Microsoft 应用程序密码留空，以匹配默认的环境变量

### 在本地团队中托管

本地托管在团队中使用 ngrok 或任何隧道软件运行，并创建一个应用程序包并上传到 Microsoft Teams 客户端。这允许您在 Teams 客户端中运行和调试您的应用程序。与纯本地选项相同，您可以从笔记本电脑上运行它。最棒的是，您可以在 IDE 中运行，并使用断点进行调试。在这里，我也总是推荐开发、测试、UAT 和生产环境用于现实生活中的应用程序开发。

为什么需要使用 ngrok 这样的隧道软件，是因为微软 Teams 是基于云的产品，只支持公开启用的 https 端点，不支持 http 端点。因此，要使您的应用程序能够在团队中工作，您需要将代码发布到您选择的云中，或者使您的本地运行实例可被外部访问。您可以使用任何隧道软件，但微软建议使用 ngrok: ngrok 为您在笔记本电脑上本地打开的端口创建一个外部可寻址的 URL。

ngrok-serve 任务构建您的项目并启动一个本地 web 服务器(`http://localhost:3007`)。然后它用一个随机的子域启动 ngrok，这个子域会创建一个到本地 web 服务器的安全 URL。

在开发过程中，可以使用 ngrok 工具进行测试，该工具可以创建一个安全的可旋转的 URL，指向您的本地 HTTP 服务器。Ngrok 作为一个依赖项包含在项目中，所以不需要设置或配置任何东西。Ngrok 已经创建了临时 URL，例如:841c87a33afc.ngrok.io，它将映射到我们本地运行的 web 服务器。然后去 Azure 门户，打开 Bot 通道注册 App。使用临时 URL 841c87a33afc.ngrok.io 更新消息传递端点，例如: [`https://841c87a33afc.ngrok.io/api/messages`](https://841c87a33afc.ngrok.io/api/messages) 。您可以通过在 bot 框架门户的 Test chat 窗口中测试 Bot 响应来验证 ngrok 正在工作。此外，您可以在需要时随时更新端点。

### 云托管，在团队中

云托管意味着您将在云 CDN 中部署生产就绪型应用。在这一章中，我将向你展示如何在云中部署一个应用程序，并在微软团队中发布它。微软推荐 Azure 和 GitHub，你可以创建一个清单包上传到 Teams 客户端。此外，您可以创建多个清单和包，以便管理开发、测试、UAT 和生产应用程序。Microsoft 还建议您使用多个清单和包来分隔开发、测试、UAT 和生产应用程序。

微软推荐 Azure，但是你可以使用任何带有 HTTPS 端点的托管云环境。永远记住，对于 Bot 和消息环境，你的应用程序应该用 Bot 框架编译。为了确保安全的环境，请明确您引用的确切域和子域，并且这些域必须在您的控制之下，并且在清单文件的有效域对象中列出。

Note

不建议使用*.azurewebsites.net

## 打包您的应用

在生产中部署您的 Microsoft Teams 应用程序是一个两步过程；第一个是我们已经讨论过的在云中托管代码。第二个是打包您的应用程序配置，并在微软团队中上传和安装。您在一个带有两个图标的清单 JSON 文件中定义您的应用程序配置，并将其捆绑在一个应用程序包中。您将需要一个应用程序包来上传和安装您的团队应用程序，并发布到不同的渠道。应用程序包是一个包含三个文件(manifest.json、outline.png 和 color.png)的. zip 文件。

*   一个名为“ **manifest.json** ”的清单文件，它指定您的应用程序的属性，并指向您的体验所需的资源，如其选项卡配置页面的位置或其 bot 和域 URL 和范围的 Microsoft 应用程序 ID。

*   透明“轮廓”图标和全“颜色”图标。

### 创建清单

约曼生成器自动创建清单；如果你想创建一个，那么使用微软团队中的 App Studio。您的清单文件必须命名为“manifest.json”并添加一般信息；app 版本；app ID 以及选项卡、机器人、消息传递扩展和连接器等功能。

始终使用当前清单架构:

```
"$schema": "https://developer.microsoft.com/json-schemas/teams/v1.7/MicrosoftTeams.schema.json",

```

### 核标准情报中心

在添加应用程序和访问应用程序时，应用程序包需要两个图标来识别您的应用程序体验。如前一节所述，图标必须包含在包中，并通过清单中的相对路径引用。每个路径的最大长度为 2048 字节，图标的格式为*.png。

### 强调色

微软团队在应用程序和标签库、机器人、弹出按钮等中使用彩色图标。该图标应为 192 x 192 像素；参见图 [11-1](#Fig1) 。你的图标可以是任何颜色，但是背景应该是强调色。

比如说你的公司是 JPOWER4。您将提交两个图标:

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig1_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig1_HTML.jpg)

图 11-1

应用程序库的图标

1.  应用程序库(192 x 192)

2.  透明(32 x 32)

## 部署并发布您的应用

创建应用程序后，有三种发布方式可供选择:

*   直接上传你的 app。

*   将您的应用程序发布到您组织的应用程序目录。

*   通过 AppSource 发布应用程序。

### 将应用程序包上传到 Microsoft 团队

要测试您的应用程序，您需要将其上传到团队。上传会将应用程序添加到您选择的团队，团队可以像最终用户一样与之交互。

### 将应用程序发布到组织的应用程序目录

使用管理应用程序页面发布专为您的组织构建的应用程序。发布自定义应用程序后，您组织的应用程序商店中的用户即可使用该应用程序。有两种方法可以将自定义应用程序发布到您组织的应用程序商店。您使用的方式取决于您获取应用程序的方式。

*   **批准自定义应用**:如果开发人员使用团队应用提交 API 将应用直接提交到管理应用页面，请使用此方法。然后，您可以直接从应用程序详细信息页面查看和发布(或拒绝)应用程序。

*   **上传 app 包**:如果开发者把 app 包发给你，就用这个方法。zip 格式。您通过上传应用程序包来发布应用程序。

**通过 AppSource 发布您的应用**

将您的应用程序发布到 AppSource 可使其在 Web 上的团队应用程序目录中可用。

## 最佳实践

### 制表符

*   **总是包含一个默认状态**:如果你的标签页是可配置的或者静态的，总是包含一个默认状态；它将帮助您轻松设置选项卡。

*   **深度链接**:通过始终在标签中深度链接你的卡片和机器人，你可以在托管标签中显示更丰富的数据。

*   **命名**:始终使用有意义的全名，并将其与您的业务线对应起来。

### 蝇蛆病

*   机器人不是助手:机器人是专家，所以总是包括认知服务。

*   **劝阻聊天**:使用你的机器人进行对话；否则，将它重定向到任务完成。

*   **介绍一些性格**:例子:现在语音很流行，给你的 bot 介绍一些说话能力。

*   保持语气:始终包括友好、轻松的对话。

*   **鼓励轻松的任务流**:始终用任务流多轮互动提问；它将帮助用户从机器人那里获得正确的答案。

### 消息传递扩展

*   保持简单:消息扩展应该是轻量级和快速的，否则它将失去效用。如果您的搜索需求非常复杂或者需要多个参数，即使在最简单的情况下，包含它们也是可以的。

*   优化你的搜索结果:一个简洁的消息扩展将返回一个易于理解的搜索结果列表。我们建议包含一张图片和不超过两行的文本。

*   **优化您的卡片**:每个消息扩展都在卡片中生成。因为这是你的用户最后会看到的东西，所以要确保你的卡片有用、好看，并且易于分享。

### 信用卡

*   **降低噪音**:例如:微软团队应用支持一起发送多张卡片，但它们变得不太有用，因为无法在单个视图中看到响应的用户需要向下滚动。

*   **在移动设备上测试**:在创建卡片时，始终考虑移动设备。尽量避免大图片、大数据集和大段文字。还要考虑标题、宽度以及在手机上被截断的文本长度。发布到生产之前在移动设备中进行测试。

*   **检查您的显卡**:始终在移动、桌面和浏览器等所有平台上测试图像和视频。

**避免在图形中包含文本**:在文本字段中加载测试消息，但不要在图像或视频中加载。由于图像和视频是动态缩放的，因此图像中的任何文本都会加载到错误的位置。

### 任务模块

*   **在频道**中:使用任务模块与用户进行 1:1 的互动。任务模块可以防止不必要的机器人响应干扰频道，并避免将用户重定向到 1:1 聊天和丢失上下文。

*   **在移动设备上测试**:虽然任务模块中托管的自适应卡在移动设备上表现良好，但如果您选择创建自定义 HTML，它将需要使用我们的 CSS 来处理主题变化，并响应处理桌面和移动屏幕空间之间的差异。

*   **简短的交互**:你可以很容易地创建多步向导，但是将用户留在任务模块中可能会有问题，因为进来的消息会鼓励用户退出。如果你的任务真的很复杂或者很费时间，跳出到一个网页而不是一个任务模块。

*   **错误**:保持错误内联。不要在对话框上弹出对话框。

### 消息操作

*   **简单的动作名称**:保持名称简短:最多两个单词。

*   **使用任务模块**:允许通过在任务模块中暴露动作来控制动作，或者只是打开它来确认动作已经完成。

*   尝试使用自然语言处理 : NLP 可以帮助您的服务监听实体的关键字或同义词。

*   **也尝试使用图形查询**:一旦你在处理用户发送的文本，你就可以利用 MS Graph 来获得更多的上下文。这样做需要额外的权限，您需要通知用户。

### 活动源

*   **保持简短**:确保事情简短，因为较长的消息会被截断。

*   **捆绑你的通知**:如果你的服务经常同时发送许多通知，试着把它们组合成一个通知。例如:“分配给你 10 项任务。”

## 练习-将您的应用程序发布到您的组织

在前几章中，我们开发了团队应用程序并在本地进行了测试。Ngrok 允许我们快速测试应用程序。然而，在现实生活中，我们必须将这些团队应用程序部署到一些托管环境中，从那里它们可以被提供给微软团队。

在本练习中，我们将了解如何将您的应用部署和发布到您组织的生产环境中；也就是说，创建一个新的 Teams 应用程序，并将其资产部署到 Azure Content Delivery Network 作为托管解决方案。

在开始练习之前，请验证您的环境。在本练习中，我将使用下面提到的工具，这些工具安装在我的环境中:

*   Microsoft Azure 订阅

*   GitHub 帐户

*   Node.js - v10.16.0

*   NPM - 6.9.0

*   吞咽
    *   CLI 版本:2.3.0

    *   本地版本:4.0.2

*   MS 团队的约曼生成器- 2.14.0

*   Visual Studio 代码

### 涉及的步骤

如果您想为生产部署 Teams 应用程序，请遵循以下步骤。

1.  在 Azure 中创建 Web 应用程序

2.  在 GitHub 中创建一个资源库

3.  使用“yo teams”创建应用程序

4.  使用 Git 部署到 Azure

5.  将包部署到团队来测试应用程序

### 在 Azure 中创建 Web 应用程序

在本节中，您将创建一个 web 应用程序，将您的应用程序发布到公共领域，以便从任何地方进行访问。打开浏览器，导航到 Azure 门户 [`https://portal.azure.com/`](https://portal.azure.com/) 。使用您在 Azure 订阅中使用的**username@tenantname.onmicrosoft.com**登录。

——[`https://portal.azure.com/`](https://portal.azure.com/)

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig2_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig2_HTML.jpg)

图 11-2

创建资源

*   创建新的资源组或使用现有的资源组。

*   在本练习中，我将使用现有的资源组“团队”

*   点击“创建资源”(图 [11-2](#Fig2) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig3_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig3_HTML.jpg)

图 11-3

创建 Web 应用程序

*   选择“网络应用”(图 [11-3](#Fig3) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig4_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig4_HTML.jpg)

图 11-4

创建和查看 Web 应用程序

*   使用 Windows 应用服务计划创建一个 Web 应用，并为其命名您的选项卡，与您在 Yeoman generator 中被要求提供 URL 时使用的名称相同。本例:`https://deployfirstteamsapp. azurewebsites.net`(图 [11-4](#Fig4) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig5_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig5_HTML.jpg)

图 11-5

Web 应用程序已创建

*   点击查看和创建按钮创建一个 Web 应用程序(图 [11-5](#Fig5) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig6_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig6_HTML.jpg)

图 11-6

配置设置

*   转到设置下的配置

*   在配置➤ **应用设置**中添加以下按键(图 [11-6](#Fig6) )

*   新的应用程序设置(图 [11-7](#Fig7) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig7_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig7_HTML.jpg)

图 11-7

应用程序设置

```
Name = WEBSITE_NODE_DEFAULT_VERSION, Value = 8.10.0 and
Name = SCM_COMMAND_IDLE_TIMEOUT, Value = 1800

```

*   单击保存。

### 在 GitHub 中创建一个资源库

在本节中，您将创建一个新的存储库，并使用您的本地项目文件夹进行映射。打开浏览器，登录 GitHub 示例: [`https://github.com/jenkinsns`](https://github.com/jenkinsns) (我的仓库)，如果没有 GitHub 仓库账号，那么创建一个。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig8_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig8_HTML.jpg)

图 11-8

创建新的存储库

*   转到存储库

*   单击“新建”按钮并创建新的存储库

*   储存库名称:deployfirstteamsapp

*   点击“创建资源库”按钮，在 GitHub 中创建新的资源库(图 [11-8](#Fig8)

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig9_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig9_HTML.jpg)

图 11-9

用 GitHub 桌面打开

*   如果你的笔记本电脑或台式机中没有 GitHub Desktop，安装它。

*   点击代码按钮➤选择打开 GitHub 桌面(图 [11-9](#Fig9) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig10_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig10_HTML.jpg)

图 11-10

克隆存储库

*   然后映射/克隆新应用的项目文件夹(图 [11-10](#Fig10) )。

### 使用“yo teams”创建应用程序

在本节中，您将使用 Yeoman generator (yo teams)创建一个新的 tab Teams 应用程序:

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig11_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig11_HTML.jpg)

图 11-11

yo 团队发电机

*   打开命令提示符

*   导航到从 github 映射/克隆的项目文件夹

*   **示例**:C:\ Jenkins \ jpower 4 \ Book \ app deployment \ deployfirsteamsapp

*   通过运行以下命令为微软团队运行 Yeoman generator:**yo Teams**(图 [11-11](#Fig11) )。

约曼将发射并问你一系列问题。用以下数值回答问题(图 [11-12](#Fig12) ):

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig12_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig12_HTML.jpg)

图 11-12

回答约曼问卷

*   您的解决方案名称是什么？**部署 firstteamsapp**

*   您想将文件放在哪里？使用当前文件夹

*   您的 Microsoft Teams 应用程序项目的标题？**部署 firstteamsapp**

*   你(公司)的名字？(最多 32 个字符)JPOWER4

*   您希望使用哪个清单版本？v1.6

*   如果您有 Microsoft Partner ID，请输入。(留空以跳过)

*   您希望在项目中添加哪些功能？一个标签

*   您将在其中托管此解决方案的 URL？ [`https://deployfirstteamsapp.azurewebsites.net`](https://deployfirstteamsapp.azurewebsites.net) ( **输入在 Azure Portal 中创建的 Web App URL)**

*   当你的应用程序/标签加载时，你想显示加载指示器吗？不

*   是否要包括测试框架和初始测试？不

*   您希望将 Azure Applications Insights 用于遥测吗？不

*   默认选项卡名称？(最多 16 个字符)我的标签

*   您想创建哪种选项卡？个人(静态)

*   该选项卡是否需要 Azure AD 单点登录支持？不

Note

这些问题的大多数答案在创建项目后都可以更改。例如，在创建或测试项目时，项目所在的 URL 并不重要

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig13_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig13_HTML.jpg)

图 11-13

Visual Studio 代码

*   使用**代码打开 Visual Studio 代码。在命令提示符下**(图 [11-13](#Fig13) )。

*   为团队选项卡应用程序添加您的功能

*   保存

### 使用 Git 部署到 Azure

在本节中，您将设置在前面步骤中创建的 web app 部署中心，并使用 GitHub 存储库配置部署构建服务。

1.  转到命令提示符

2.  在选项卡文件夹中，使用 **git init** 初始化 Git 存储库

3.  使用 **gulp build** 构建解决方案，确保没有任何错误

4.  使用**git add-A&T3】git commit-m“初始提交”**提交所有文件

5.  运行以下命令来设置远程存储库:

    ```
    git remote add azure  https://<username>@deployfirstteamsapp.scm.azurewebsites.net:443/deployfirstteamsapp.git.

    ```

6.  您需要将其替换为您在部署凭据中检索的应用凭据的用户名。你也可以从 Azure Web 应用程序的选项中复制 URL(图 [11-19](#Fig19) )。

    ```
    i.e., git remote add azure  https://$deployfirstteamsapp@deployfirstteamsapp.scm.azurewebsites.net:443/deployfirstteamsapp.git

    ```

7.  要将您的代码应用到 Azure，请使用以下命令:

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig18_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig18_HTML.jpg)

图 11-18

存储部署凭据

1.  安全地复制和存储应用凭证(图 [11-18](#Fig18)
    1.  Git 克隆 URL

    2.  用户名

    3.  密码

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig17_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig17_HTML.jpg)

图 11-17

获取部署凭据

1.  单击完成

2.  点击部署凭证(图 [11-17](#Fig17)

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig16_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig16_HTML.jpg)

图 11-16

应用服务构建服务

1.  App Service 作为构建提供者构建服务(图 [11-16](#Fig16) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig15_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig15_HTML.jpg)

图 11-15

部署中心的本地 Git

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig14_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig14_HTML.jpg)

图 11-14

Web 应用部署中心

1.  登录 Azure 门户- [`https://portal.azure.com/`](https://portal.azure.com/)

2.  打开创建的 web app**deployfirsteamsapp**(图 [11-14](#Fig14) )

3.  进入部署中的部署中心(图 [11-15](#Fig15)

4.  选择本地 Git 作为源

1.  完成的

2.  对您执行的和想要部署的每个提交重复步骤 11。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig20_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig20_HTML.jpg)

图 11-20

部署开始

1.  等到部署完成后，导航到 [`https://deployfirstteamsapp.azurewebsites.net/privacy.html`](https://deployfirstteamsapp.azurewebsites.net/privacy.html) 来测试 web 应用程序是否正在运行(图 [11-20](#Fig20) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig19_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig19_HTML.jpg)

图 11-19

输入部署密码

1.  第一次会要求您提供凭据，因此请输入应用凭据的密码。

```
git push azure master

```

### 将包部署到团队来测试应用程序

现在让我们在微软团队中安装应用程序。在浏览器中，导航至 [`https://teams.microsoft.com`](https://teams.microsoft.com) 并登录。

使用应用程序栏导航菜单，选择更多添加的应用程序按钮。然后选择更多应用，接着上传自定义应用，然后为我或我的团队上传(图 [11-21](#Fig21) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig21_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig21_HTML.jpg)

图 11-21

向 MS 团队添加应用

在出现的文件对话框中，选择项目中的 Microsoft Teams 包。这个应用程序包是一个 ZIP 文件，可以在项目**中找到。/包**文件夹(图 [11-22](#Fig22) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig22_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig22_HTML.jpg)

图 11-22

上传应用程序

安装后，您将能够在应用程序列表中看到该应用程序(图 [11-23](#Fig23) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig23_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig23_HTML.jpg)

图 11-23

安装的个人应用程序

点击该应用程序，微软团队将显示该应用程序的摘要(图 [11-24](#Fig24) )。

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig24_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig24_HTML.jpg)

图 11-24

添加个人选项卡

### 测试部署的应用程序

![../images/502225_1_En_11_Chapter/502225_1_En_11_Fig25_HTML.jpg](../images/502225_1_En_11_Chapter/502225_1_En_11_Fig25_HTML.jpg)

图 11-25

个人标签输出

*   单击“添加”按钮，导航到“个人”选项卡进行测试。

*   此外，您可以将个人选项卡永久固定在最左侧的导航栏中。

*   或者选择...菜单并从列表中选择您的应用程序(图 [11-25](#Fig25) )。

在本练习中，您已经在 Azure Web 应用程序中部署了您的代码，并将该应用程序作为个人选项卡安装在 Microsoft Teams 中，并从 Microsoft Teams 客户端对其进行了测试。

## 结论

在本章中，您学习了部署的各种功能、最佳实践，以及如何在 Azure Web 应用程序中部署您的代码，并使用 Yeoman generator (yo teams)和 Git 将应用程序安装到 Microsoft 团队。您还学习了如何使用 Git for Microsoft Teams 在 Azure 中部署 Teams 应用程序。

这本书向您展示了如何为微软团队构建业务线应用程序。虽然有很多方法来开发团队定制应用程序，但与其他工具相比，yo teams 更好，这些工具可以轻松开发和部署，没有任何依赖性。本书涵盖了消息传递扩展、机器人、标签、Webhooks 和连接器的逐步构建。它还涵盖了团队和现成的应用程序模板和部署神话表面 SPFx。